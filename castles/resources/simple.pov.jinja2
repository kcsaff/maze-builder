#include "colors.inc"
background { color Black }
camera {
    location <10, 10, 10>
    look_at  <0, 0, 0>
}
light_source { <-30, 200, 140> color White }

global_settings {
    radiosity {
      pretrace_start 0.08
      pretrace_end   0.01
      count 150
      nearest_count 10
      error_bound 0.5
      recursion_limit 3
      low_error_factor 0.5
      gray_threshold 0.0
      minimum_reuse 0.005
      maximum_reuse 0.2
      brightness 1
      adc_bailout 0.005
    }
  }

plane { y, 0 pigment { White } }

#declare HEIGHT=1.5;
#declare FENCE=1.0;
#declare R1=seed(1);

#macro MakeWallX (X, Y, Z)
    box { <X-0.1, Z+0, Y-0.1>, <X+1.1, Z+HEIGHT, Y+0.1> pigment { White } }
#end

#macro MakeWallY (X, Y, Z)
    box { <X-0.1, Z+0, Y-0.1>, <X+0.1, Z+HEIGHT, Y+1.1> pigment { White } }
#end

#macro MakeArchX (X, Y, Z)
    box { <X-0.1, Z+HEIGHT-0.2, Y-0.1>, <X+1.1, Z+HEIGHT, Y+0.1> pigment { White } }
#end

#macro MakeArchY (X, Y, Z)
    box { <X-0.1, Z+HEIGHT-0.2, Y-0.1>, <X+0.1, Z+HEIGHT, Y+1.1> pigment { White } }
#end

#macro MakeOpenX (X, Y, Z)
#end

#macro MakeOpenY (X, Y, Z)
#end

#macro MakeBlockX (X, Y, Z)
    box { <X-0.10, Z+0, Y-0.10>, <X+0.10, Z+HEIGHT, Y+0.10> pigment { White } }
    box { <X+0.15, Z+0, Y-0.05>, <X+0.25, Z+FENCE, Y+0.05> pigment { White } }
    box { <X+0.35, Z+0, Y-0.05>, <X+0.45, Z+FENCE, Y+0.05> pigment { White } }
    box { <X+0.55, Z+0, Y-0.05>, <X+0.65, Z+FENCE, Y+0.05> pigment { White } }
    box { <X+0.75, Z+0, Y-0.05>, <X+0.85, Z+FENCE, Y+0.05> pigment { White } }
    box { <X+0.90, Z+0, Y-0.10>, <X+1.10, Z+HEIGHT, Y+0.10> pigment { White } }
#end

#macro MakeBlockY (X, Y, Z)
    box { <X-0.10, Z+0, Y-0.10>, <X+0.10, Z+HEIGHT, Y+0.10> pigment { White } }
    box { <X-0.05, Z+0, Y+0.15>, <X+0.05, Z+FENCE, Y+0.25> pigment { White } }
    box { <X-0.05, Z+0, Y+0.35>, <X+0.05, Z+FENCE, Y+0.45> pigment { White } }
    box { <X-0.05, Z+0, Y+0.55>, <X+0.05, Z+FENCE, Y+0.65> pigment { White } }
    box { <X-0.05, Z+0, Y+0.75>, <X+0.05, Z+FENCE, Y+0.85> pigment { White } }
    box { <X-0.10, Z+0, Y+0.90>, <X+0.10, Z+HEIGHT, Y+1.10> pigment { White } }
#end

#macro MakeFeature (X, Y, Z)
    box { <X-0.5, Z+0, Y-0.5>, <X+0.5, Z+HEIGHT, Y+0.5> pigment { White } }

    #local spire = HEIGHT + 1.0 + 2*HEIGHT*rand(R1)*rand(R1)*rand(R1);
    box { <X-0.45, Z+HEIGHT, Y-0.45>, <X-0.37, Z+spire, Y-0.37> pigment { White } }
    box { <X-0.45, Z+HEIGHT, Y+0.37>, <X-0.37, Z+spire, Y+0.45> pigment { White } }
    box { <X+0.37, Z+HEIGHT, Y+0.37>, <X+0.45, Z+spire, Y+0.45> pigment { White } }
    box { <X+0.37, Z+HEIGHT, Y-0.45>, <X+0.45, Z+spire, Y-0.37> pigment { White } }
    box { <X-0.5, Z+spire, Y-0.5>, <X+0.5, Z+spire+0.25, Y+0.5> pigment { White } }

    prism {
        conic_sweep
        linear_spline
        0, // height 1
        1, // height 2
        5, // the number of points making up the shape...
        <0.6,0.6>,<-0.6,0.6>,<-0.6,-0.6>,<0.6,-0.6>,<0.6,0.6>
        rotate <180, 0, 0>
        scale <1, HEIGHT, 1>
        translate <X, spire+0.25+HEIGHT, Y>
        pigment { White }
  }
#end

{% for cmd,coords in parts %}
{{ cmd }}({{ coords[0] }}, {{ coords[1] }}, {{ coords[2] }})
{% endfor %}
